{% extends 'layout.html' %}
{% load static %}
{% block headercss %}
    <link rel="stylesheet" type="text/css" href="{% static 'hospital/css/patient.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'hospital/css/weui-css/weui-dialog.css' %}">
    <link rel="stylesheet" href="{% static 'hospital/css/weui-css/weui-media-box.css' %}">
    <link rel="stylesheet" href="{% static 'hospital/css/weui-css/weui-btn.css' %}">
{% endblock %}
{% block content %}
    <div class="weui-tab">
        <div class="card_list">
            {#这里循环#}
            <div class="patient_card">
                <div class="card_top" onclick="window.location.href='{% url 'home' %}'">
                    <div class="card_left">姓名1</div>
                    <div class="card_right">卡号<text>00435505</text></div>
                </div>
                <div class="divider"></div>
                <div class="card_bottom" data-id="00" onclick="showDialog('00435505')">
                    <div class="card_left"></div>
                    <div class="card_right"><img src={% static 'hospital/img/barcode.png' %}>查看条形码</div>
                </div>
            </div>
        </div>
        <div class="weui-tabbar">
            <a href="javascript:" class="weui-btn weui-btn_primary">添加就诊人</a>
        </div>
        <div class="dialog_box" id="dialog_box" style="display: none;">
            <div class="weui-mask"></div>
            <div class="weui-dialog">
                <div class="weui-dialog__hd"><strong class="weui-dialog__title">条形码</strong></div>
                <div class="weui-dialog__bd">
                    <img id="imgcode">
                </div>
                <div class="weui-dialog__ft">
                    <a href="javascript:" class="weui-dialog__btn weui-dialog__btn_primary">关闭</a>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
{% block bodyJs %}
    <script type="text/javascript" src="{% static 'hospital/js/jquery-2.1.3.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'hospital/js/JsBarcode.all.min.js' %}"></script>
    <script type="text/javascript">
        $(function() {
            function hideDialog(element) {
                $(element).parents('.dialog_box').fadeOut(200);
            };
            // 显示操作对话框
            $('#showDialog').on('click', function() {
                console.log($(this).attr("data-id"));
                $('.dialog_box').fadeIn(200);
            });
            //点击对话框操作按钮关闭操作对话框
            $('.dialog_box').on('click', '.weui-dialog__btn', function() {
                hideDialog(this);
            });
            // 点击半透明黑色遮罩关闭操作对话框
            $('.dialog_box').on('click', '.weui-mask', function() {
                hideDialog(this);
            });
        });
        function showDialog(num) {
            JsBarcode("#imgcode", num);
            document.getElementById("dialog_box").style.display="";
        };
    </script>
{% endblock %}